<html>
<heading>
	<title>Seating</title>
	<link href="/resources/css/dragula.min.css" rel="stylesheet" type="text/css">
	<link href="/resources/css/seating.css" rel="stylesheet" type="text/css">
</heading>
<body>
	{{ nav_bar }}
	{% if not msg == None %}
	<div>
		{{msg}}
	</div>
	{% endif %}

	{% if classrooms|length > 0 %}
		<form method="get" action="/seating">
			<label>Select a Class
				<select name="classroom">
					<option value=""></option>
					{% for classroom_select in classrooms %}
						<option value="{{ classroom_select.key.urlsafe() }}">
							{{ classroom_select.name }}
						</option>
					{% endfor %}
				</select>
			</label>
			<button>Go!</button>
	  </form>
	{% else %}
		<div>You must create a classroom before you can set up seating!</div>
	{% endif %}

	{% if classroom %}
		<h1>Generate Seating</h1>
		<h2>{{ classroom.name }}</h2>
		<a href="/classroom?id={{ classroom.key.urlsafe() }}">Manage Class</a>

		{% if students|length == 30 %}
			<a href="/seating?classroom={{ classroom.key.urlsafe() }}&list=true">
				View all saved seating arrangements
			</a>

			{% if day and is_saved %}
				<h1 id="day">
					Day {{day}}
				</h1>
			{% endif %}

			<section id="room" class="clearfix">
				{% for i in range(0, students|length, 6) %}
				<div class="table clearfix container" name="{{ i / 6 }}">
					{% for j in range(6) %}
						<div class="student" id="{{ students[i + j].key.urlsafe() }}">
							{{ students[i + j].name }}
						</div>
					{% endfor %}
				</div>
				{% endfor %}
			</section>

			<form method="get" action="/seating">
				<input type="hidden" name="classroom" value="{{classroom.key.urlsafe()}}">
				<input type="submit" value="Regenerate Seating">
			</form>

			{% if day and not is_saved %}
				<form method="post" action="/seating">
					<input type="hidden" name="classroom_id"
								 value="{{ classroom.key.urlsafe() }}">
					<input type="hidden" name="keystring">
					<h4>Save This Seating Arrangement: Day {{ day }}</h4>
					<input type="hidden" name="day" value="{{ day }}">
					<input type="submit" value="Save" id="save">
				</form>
			{% endif %}
		{% else %}
			<div class="error">
				Error: Class has fewer than 30 students. Please add students.
			</div>
		{% endif %}
	{% endif %}
	<script src='/resources/scripts/dragula.min.js'></script>
	<script src='/resources/scripts/seating.js'></script>
	<script>
		document.addEventListener('DOMContentLoaded', main, false);
	</script>
</body>
</html>
